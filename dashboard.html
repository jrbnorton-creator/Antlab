<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advisory Dashboard - Roommate Cabins</title>

    <!-- External Dependencies -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Tailwind Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            dark: '#0F172A',
                            primary: '#3B82F6',
                            accent: '#F59E0B',
                            success: '#10B981',
                            danger: '#EF4444',
                            light: '#F8FAFC',
                            surface: '#FFFFFF',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        display: ['Space Grotesk', 'sans-serif'],
                    },
                    boxShadow: {
                        'soft': '0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03)',
                        'card': '0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.025)',
                        'glow': '0 0 15px rgba(59, 130, 246, 0.3)',
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'fade-in': 'fadeIn 0.8s ease-out forwards',
                        'slide-up': 'slideUp 0.6s ease-out forwards',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* ========================================
           FONTS & GLOBAL STYLES
           ======================================== */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #F1F5F9;
            color: #1E293B;
            margin: 0;
            overflow: hidden;
        }

        h1, h2, h3 {
            font-family: 'Space Grotesk', sans-serif;
        }

        /* ========================================
           SIDEBAR STYLES
           ======================================== */
        .sidebar-link {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 3px solid transparent;
        }

        .sidebar-link:hover {
            background-color: rgba(255,255,255,0.05);
            padding-left: 1.75rem;
        }

        .sidebar-link.active {
            background-color: rgba(255,255,255,0.1);
            border-left-color: #F59E0B;
        }

        /* ========================================
           CUSTOM SCROLLBAR
           ======================================== */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #CBD5E1;
            border-radius: 3px;
        }

        /* ========================================
           ANIMATIONS
           ======================================== */
        .animate-fade-up {
            animation: fadeUp 0.5s ease-out forwards;
        }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .glass-header {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            border-bottom: 1px solid rgba(226, 232, 240, 0.8);
        }

        /* ========================================
           WELCOME SCREEN STYLES - ENERGIZED! ðŸ”¥
           ======================================== */
        #welcome-screen {
            position: fixed;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-y: auto;
            background: radial-gradient(circle at 50% 50%, #1a1a1a 0%, #000000 100%);
            color: #ffffff;
            z-index: 100;
        }

        /* Animated Grid Background */
        .bg-grid {
            background-size: 50px 50px;
            background-image:
                linear-gradient(to right, rgba(255, 110, 0, 0.05) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(255, 110, 0, 0.05) 1px, transparent 1px);
            animation: gridPulse 4s ease-in-out infinite;
        }

        @keyframes gridPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        /* Floating Particles Background */
        .particles-canvas {
            position: absolute;
            inset: 0;
            pointer-events: none;
            z-index: 1;
        }

        /* Energy Orbs */
        .energy-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.15;
            animation: float 20s ease-in-out infinite;
        }

        .energy-orb-1 {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, #FF6E00, transparent);
            top: 10%;
            left: 10%;
            animation-delay: 0s;
        }

        .energy-orb-2 {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, #FF0000, transparent);
            bottom: 20%;
            right: 15%;
            animation-delay: 7s;
        }

        .energy-orb-3 {
            width: 350px;
            height: 350px;
            background: radial-gradient(circle, #FFFFFF, transparent);
            top: 50%;
            left: 50%;
            animation-delay: 3s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(50px, -50px) scale(1.1); }
            66% { transform: translate(-30px, 30px) scale(0.9); }
        }

        /* Enhanced Reveal Animations */
        .ice-reveal {
            opacity: 0;
            transform: translateY(50px) scale(0.95);
            transition: all 1.2s cubic-bezier(0.16, 1, 0.3, 1);
            filter: blur(10px);
        }

        .ice-reveal.active {
            opacity: 1;
            transform: translateY(0) scale(1);
            filter: blur(0);
        }

        /* Glowing Text Effect */
        .glow-text {
            animation: textGlow 3s ease-in-out infinite;
            text-shadow:
                0 0 10px rgba(255, 110, 0, 0.5),
                0 0 20px rgba(255, 110, 0, 0.3),
                0 0 30px rgba(255, 110, 0, 0.2);
        }

        @keyframes textGlow {
            0%, 100% {
                text-shadow:
                    0 0 10px rgba(255, 110, 0, 0.5),
                    0 0 20px rgba(255, 110, 0, 0.3),
                    0 0 30px rgba(255, 110, 0, 0.2);
            }
            50% {
                text-shadow:
                    0 0 20px rgba(255, 110, 0, 0.8),
                    0 0 40px rgba(255, 110, 0, 0.5),
                    0 0 60px rgba(255, 110, 0, 0.3);
            }
        }

        /* ========================================
           ICE CYCLE DIAGRAM - SUPERCHARGED! âš¡
           ======================================== */
        .ice-track-ring {
            position: absolute;
            width: 65%;
            height: 65%;
            border: 2px dashed rgba(255,110,0,0.3);
            border-radius: 50%;
            animation: spinSlow 30s linear infinite;
            filter: drop-shadow(0 0 20px rgba(255, 110, 0, 0.2));
        }

        .ice-track-ring::before {
            content: '';
            position: absolute;
            inset: -10px;
            border-radius: 50%;
            background: conic-gradient(
                from 0deg,
                transparent 0deg,
                rgba(255, 110, 0, 0.1) 90deg,
                transparent 180deg
            );
            animation: spinFast 8s linear infinite;
        }

        .ice-track-ring::after {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            padding: 4px;
            background: conic-gradient(
                from 0deg,
                #FF6E00,
                #FF0000 120deg,
                transparent 180deg,
                transparent
            );
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            filter: drop-shadow(0 0 15px rgba(255, 110, 0, 0.8));
            animation: glowPulse 2s ease-in-out infinite;
        }

        @keyframes spinSlow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes spinFast {
            from { transform: rotate(360deg); }
            to { transform: rotate(0deg); }
        }

        @keyframes glowPulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        /* Energized Arrows */
        .ice-cycle-arrow {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            transform: translate(-50%, -50%) rotate(var(--rot));
            animation: arrowPulse 2s ease-in-out infinite;
            animation-delay: var(--delay, 0s);
        }

        @keyframes arrowPulse {
            0%, 100% {
                opacity: 0.4;
                filter: drop-shadow(0 0 5px rgba(255, 110, 0, 0.3));
            }
            50% {
                opacity: 1;
                filter: drop-shadow(0 0 15px rgba(255, 110, 0, 0.8));
            }
        }

        .ice-cycle-arrow::after {
            content: '';
            position: absolute;
            top: -10px;
            left: 50%;
            width: 16px;
            height: 16px;
            border-top: 3px solid #FF6E00;
            border-right: 3px solid #FF6E00;
            transform: translateX(-50%) rotate(45deg);
            box-shadow: 0 0 10px rgba(255, 110, 0, 0.5);
        }

        /* Animated ICE Center Text */
        .ice-center-text-glow {
            animation: iceTextPulse 4s ease-in-out infinite;
            filter: drop-shadow(0 0 30px rgba(255, 110, 0, 0.6));
        }

        @keyframes iceTextPulse {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 30px rgba(255, 110, 0, 0.6));
            }
            50% {
                transform: scale(1.08);
                filter: drop-shadow(0 0 50px rgba(255, 110, 0, 0.9));
            }
        }

        /* Enhanced ICE Nodes */
        .ice-node {
            position: absolute;
            width: 220px;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .ice-node:hover {
            transform: scale(1.15) translateY(-10px);
            filter: drop-shadow(0 10px 30px rgba(255, 110, 0, 0.4));
        }

        .ice-node.pos-1 { top: -5%; }
        .ice-node.pos-2 { bottom: 10%; right: -15%; }
        .ice-node.pos-3 { bottom: 10%; left: -15%; }

        /* Pulsing Dots */
        .ice-dot-pulse {
            animation: dotExpand 2s ease-in-out infinite;
        }

        @keyframes dotExpand {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 15px currentColor;
            }
            50% {
                transform: scale(1.3);
                box-shadow: 0 0 30px currentColor, 0 0 50px currentColor;
            }
        }

        /* Energized Button */
        .energy-button {
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
            transition: all 0.3s ease;
        }

        .energy-button::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(45deg, #FF6E00, #FF0000, #FF6E00);
            background-size: 200% 200%;
            animation: gradientShift 3s ease infinite;
            border-radius: 9999px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: -1;
        }

        .energy-button:hover::before {
            opacity: 1;
        }

        .energy-button::after {
            content: '';
            position: absolute;
            inset: 0;
            background: inherit;
            border-radius: inherit;
            z-index: -1;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .energy-button:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow:
                0 20px 60px rgba(255, 110, 0, 0.3),
                0 0 40px rgba(255, 110, 0, 0.2),
                inset 0 0 20px rgba(255, 255, 255, 0.1);
        }

        .energy-button:active {
            transform: translateY(-2px) scale(1.02);
        }

        /* Shimmer Effect */
        .shimmer {
            position: relative;
            overflow: hidden;
        }

        .shimmer::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.2),
                transparent
            );
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            to { left: 100%; }
        }
    </style>
</head>

<body class="h-screen flex overflow-hidden bg-brand-light">

    <!-- ========================================
         WELCOME SCREEN - ENERGIZED! âš¡ðŸ”¥
         ======================================== -->
    <div id="welcome-screen" class="bg-grid">
        <!-- Floating Energy Orbs -->
        <div class="energy-orb energy-orb-1"></div>
        <div class="energy-orb energy-orb-2"></div>
        <div class="energy-orb energy-orb-3"></div>

        <!-- Canvas for Particle Effects -->
        <canvas id="particles-canvas" class="particles-canvas"></canvas>

        <div class="max-w-6xl w-full px-8 py-20 flex flex-col items-center relative z-10">
            <!-- Header Text with Glow -->
            <div class="text-left w-full max-w-[1100px] ice-reveal active mb-16 shimmer">
                <h2 class="text-4xl md:text-7xl font-light text-white leading-tight">
                    How we <b class="font-bold glow-text">build better businesses</b><span class="text-red-600 glow-text">.</span>
                </h2>
            </div>

            <!-- ICE Cycle Diagram - Supercharged! -->
            <div class="relative w-full max-w-[600px] aspect-square flex items-center justify-center ice-reveal active" style="transition-delay: 0.2s;">
                <div class="text-5xl md:text-7xl font-bold tracking-tighter text-white z-10 ice-center-text-glow">ICE</div>

                <div class="ice-track-ring">
                    <div class="ice-cycle-arrow" style="--rot: 0deg; --delay: 0s;"></div>
                    <div class="ice-cycle-arrow" style="--rot: 120deg; --delay: 0.6s;"></div>
                    <div class="ice-cycle-arrow" style="--rot: 240deg; --delay: 1.2s;"></div>
                </div>

                <!-- Identify -->
                <div class="ice-node pos-1">
                    <div class="w-4 h-4 bg-orange-500 rounded-full mx-auto mb-4 ice-dot-pulse" style="color: #FF6E00;"></div>
                    <h3 class="text-sm font-bold uppercase tracking-widest text-white mb-2">Identify</h3>
                    <p class="text-xs text-slate-400 mt-2 px-4">Identify Asset Disconnect.<br><span class="text-orange-400">Shift to Finance Product.</span></p>
                </div>

                <!-- Cleanse -->
                <div class="ice-node pos-2">
                    <div class="w-4 h-4 bg-white rounded-full mx-auto mb-4 ice-dot-pulse" style="color: #FFFFFF;"></div>
                    <h3 class="text-sm font-bold uppercase tracking-widest text-white mb-2">Cleanse</h3>
                    <p class="text-xs text-slate-400 mt-2 px-4">Link Cabin to Loan.<br><span class="text-white">Track Utilization.</span></p>
                </div>

                <!-- Execute -->
                <div class="ice-node pos-3">
                    <div class="w-4 h-4 bg-red-600 rounded-full mx-auto mb-4 ice-dot-pulse" style="color: #DC2626;"></div>
                    <h3 class="text-sm font-bold uppercase tracking-widest text-white mb-2">Execute</h3>
                    <p class="text-xs text-slate-400 mt-2 px-4">Loan-Linked COA.<br><span class="text-red-400">Track True Yield.</span></p>
                </div>
            </div>

            <!-- Enter Button - ENERGIZED! -->
            <div class="text-center mt-12 ice-reveal active" style="transition-delay: 0.4s;">
                <button id="enter-dashboard-btn" class="energy-button shimmer group bg-white text-black px-12 py-5 rounded-full font-bold text-xl flex items-center gap-3 mx-auto cursor-pointer relative z-50">
                    <span class="relative z-10">âš¡ Enter Dashboard</span>
                    <svg class="w-6 h-6 relative z-10 group-hover:translate-x-2 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                    </svg>
                </button>
                <p class="text-slate-500 text-xs mt-6 animate-pulse">ðŸš€ Experience the power of data-driven insights</p>
            </div>
        </div>
    </div>

    <!-- ========================================
         MAIN DASHBOARD CONTAINER
         ======================================== -->
    <div id="dashboard-container" class="hidden h-screen w-full flex overflow-hidden bg-brand-light">

        <!-- SIDEBAR -->
        <aside class="w-72 bg-brand-dark flex flex-col text-slate-300 flex-shrink-0 z-20 shadow-2xl">
            <div class="h-24 flex items-center px-8 bg-black/20">
                <div class="w-12 h-12 bg-brand-accent rounded-xl flex items-center justify-center text-white font-bold text-2xl mr-4 shadow-glow transform rotate-3">ICE</div>
                <div>
                    <span class="font-bold text-white text-lg block leading-tight">Roommate<br>Cabins</span>
                </div>
            </div>

            <nav class="flex-1 py-8 space-y-2 px-2">
                <button data-view="identify" class="sidebar-link active w-full flex items-center px-6 py-4 rounded-lg text-sm font-medium justify-between group">
                    <div class="flex items-center gap-4">
                        <span class="w-6 h-6 flex items-center justify-center bg-blue-500/20 text-blue-400 rounded font-bold">I</span>
                        <span>Identify</span>
                    </div>
                </button>
                <button data-view="cleanse" class="sidebar-link w-full flex items-center px-6 py-4 rounded-lg text-sm font-medium justify-between group">
                    <div class="flex items-center gap-4">
                        <span class="w-6 h-6 flex items-center justify-center bg-purple-500/20 text-purple-400 rounded font-bold">C</span>
                        <span>Cleanse</span>
                    </div>
                </button>
                <button data-view="execute" class="sidebar-link w-full flex items-center px-6 py-4 rounded-lg text-sm font-medium justify-between group">
                    <div class="flex items-center gap-4">
                        <span class="w-6 h-6 flex items-center justify-center bg-emerald-500/20 text-emerald-400 rounded font-bold">E</span>
                        <span>Execute</span>
                    </div>
                </button>

                <div class="px-6 py-4"><div class="border-t border-slate-700"></div></div>

                <button data-view="pricing" class="sidebar-link w-full flex items-center px-6 py-3 rounded-lg text-sm font-medium hover:text-white">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8a7 7 0 100 14A7 7 0 0012 8zM12 8V6m0 12v-2"></path>
                    </svg>
                    Lease Yield Model
                </button>
            </nav>

            <div class="p-6 bg-slate-900 border-t border-slate-800">
                <div class="flex items-center gap-3">
                    <div class="relative">
                        <div class="w-3 h-3 rounded-full bg-brand-success"></div>
                        <div class="absolute top-0 left-0 w-3 h-3 rounded-full bg-brand-success animate-ping"></div>
                    </div>
                    <div>
                        <p class="text-xs font-bold text-white uppercase">Data Source</p>
                        <p class="text-[10px] text-slate-400">Antlab Diagnostic 2026</p>
                    </div>
                </div>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="flex-1 flex flex-col h-full overflow-hidden relative">

            <!-- Header -->
            <header class="h-20 glass-header flex justify-between items-center px-10 flex-shrink-0 z-10 sticky top-0">
                <div>
                    <h2 class="text-2xl font-bold text-brand-dark tracking-tight">Financial Restructure Advisory</h2>
                    <p class="text-xs text-slate-500 font-medium mt-1">Roommate Cabins East Coast Ltd â€¢ YTD 2026 Analysis</p>
                </div>
                <div class="flex items-center gap-3">
                    <span class="text-xs font-bold uppercase text-slate-400">Current Phase</span>
                    <div class="px-4 py-1.5 bg-brand-primary/10 text-brand-primary rounded-full border border-brand-primary/20 shadow-sm">
                        <span class="text-xs font-bold tracking-wider" id="phase-badge">IDENTIFY</span>
                    </div>
                </div>
            </header>

            <!-- SCROLLABLE CONTENT -->
            <div class="flex-1 overflow-y-auto p-10 relative scroll-smooth bg-slate-50">

                <!-- VIEW: IDENTIFY -->
                <div id="view-identify" class="view-section animate-fade-up">

                    <!-- ICE Infographic -->
                    <div class="bg-white rounded-2xl shadow-card p-8 mb-10 border border-slate-100 relative overflow-hidden group">
                        <div class="absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r from-blue-500 via-purple-500 to-emerald-500"></div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-12 relative z-10 pt-4">
                            <!-- Step 1 -->
                            <div class="text-center relative">
                                <div class="w-16 h-16 mx-auto bg-white border-2 border-blue-100 rounded-2xl shadow-sm flex items-center justify-center text-2xl font-black text-blue-500 mb-4 z-10 relative group-hover:scale-110 transition-transform duration-300">I</div>
                                <h4 class="text-lg font-bold text-slate-800">Identify</h4>
                                <p class="text-sm text-slate-500 mt-2 px-4"><strong>The Bigger Issue:</strong> Asset & Funding Disconnect. We cannot calculate true yield because loans aren't tied to specific cabins.</p>
                                <div class="hidden md:block absolute top-8 left-1/2 w-full h-0.5 bg-slate-100 -z-10"></div>
                            </div>
                            <!-- Step 2 -->
                            <div class="text-center relative">
                                <div class="w-16 h-16 mx-auto bg-white border-2 border-purple-100 rounded-2xl shadow-sm flex items-center justify-center text-2xl font-black text-purple-500 mb-4 z-10 relative group-hover:scale-110 transition-transform duration-300 delay-75">C</div>
                                <h4 class="text-lg font-bold text-slate-800">Cleanse</h4>
                                <p class="text-sm text-slate-500 mt-2 px-4"><strong>Asset Hygiene:</strong> ID every cabin, link to a loan, and track location.</p>
                                <div class="hidden md:block absolute top-8 left-1/2 w-full h-0.5 bg-slate-100 -z-10"></div>
                            </div>
                            <!-- Step 3 -->
                            <div class="text-center relative">
                                <div class="w-16 h-16 mx-auto bg-white border-2 border-emerald-100 rounded-2xl shadow-sm flex items-center justify-center text-2xl font-black text-emerald-500 mb-4 z-10 relative group-hover:scale-110 transition-transform duration-300 delay-150">E</div>
                                <h4 class="text-lg font-bold text-slate-800">Execute</h4>
                                <p class="text-sm text-slate-500 mt-2 px-4"><strong>New COA Structure:</strong> Implement loan-linked income and expense accounts.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Strategy Comparison -->
                    <div class="bg-white rounded-xl shadow-card p-8 mb-8 border border-blue-100">
                        <h3 class="text-xl font-bold text-slate-800 mb-6 text-center">Strategic Shift: Defining the Model</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center relative">
                            <!-- Connector Icon -->
                            <div class="hidden md:flex absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-10 h-10 bg-white rounded-full border border-slate-200 items-center justify-center text-slate-400 z-10 shadow-sm">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                                </svg>
                            </div>

                            <!-- Current State -->
                            <div class="p-6 bg-red-50 rounded-xl border border-red-100 relative overflow-hidden">
                                <div class="absolute -right-4 -top-4 w-20 h-20 bg-red-100 rounded-full opacity-50"></div>
                                <span class="text-xs font-bold text-red-500 uppercase tracking-wider mb-2 block">Current State</span>
                                <h4 class="text-lg font-bold text-red-700 mb-4">Blended Asset Model</h4>
                                <div class="space-y-3">
                                    <div class="flex items-start gap-3">
                                        <div class="w-5 h-5 bg-red-200 rounded-full flex items-center justify-center text-red-600 text-xs font-bold mt-0.5">X</div>
                                        <p class="text-sm text-red-800">All income into one bucket ($613k total)</p>
                                    </div>
                                    <div class="flex items-start gap-3">
                                        <div class="w-5 h-5 bg-red-200 rounded-full flex items-center justify-center text-red-600 text-xs font-bold mt-0.5">X</div>
                                        <p class="text-sm text-red-800">All loan interest lumped together ($50k total)</p>
                                    </div>
                                    <div class="flex items-start gap-3">
                                        <div class="w-5 h-5 bg-red-200 rounded-full flex items-center justify-center text-red-600 text-xs font-bold mt-0.5">X</div>
                                        <p class="text-sm text-red-800"><strong>Result:</strong> Cannot see which specific cabins are losing money.</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Future State -->
                            <div class="p-6 bg-blue-50 rounded-xl border border-blue-100 relative overflow-hidden shadow-sm">
                                <div class="absolute -right-4 -top-4 w-20 h-20 bg-blue-100 rounded-full opacity-50"></div>
                                <span class="text-xs font-bold text-blue-600 uppercase tracking-wider mb-2 block">New Approach</span>
                                <h4 class="text-lg font-bold text-blue-800 mb-4">Finance Product Model</h4>
                                <div class="space-y-3">
                                    <div class="flex items-start gap-3">
                                        <div class="w-5 h-5 bg-blue-200 rounded-full flex items-center justify-center text-blue-600 text-xs font-bold mt-0.5">âœ“</div>
                                        <p class="text-sm text-blue-900">Cabin #101 Income linked to Loan #101 Cost</p>
                                    </div>
                                    <div class="flex items-start gap-3">
                                        <div class="w-5 h-5 bg-blue-200 rounded-full flex items-center justify-center text-blue-600 text-xs font-bold mt-0.5">âœ“</div>
                                        <p class="text-sm text-blue-900">Real-time Net Yield per Asset calculated</p>
                                    </div>
                                    <div class="flex items-start gap-3">
                                        <div class="w-5 h-5 bg-blue-200 rounded-full flex items-center justify-center text-blue-600 text-xs font-bold mt-0.5">âœ“</div>
                                        <p class="text-sm text-blue-900"><strong>Result:</strong> Identify high-cost loans to refinance immediately.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Analysis Table -->
                    <div class="bg-white rounded-xl shadow-card border border-slate-200 overflow-hidden mb-8">
                        <div class="px-8 py-5 border-b border-slate-100 bg-slate-50/50 flex justify-between items-center">
                            <h3 class="font-bold text-slate-800">Strategic Goal: The Finance Product Shift</h3>
                            <span class="text-xs font-bold text-brand-accent bg-amber-50 px-3 py-1 rounded-full border border-amber-100">Critical Priority</span>
                        </div>
                        <div class="p-6">
                            <p class="text-sm text-slate-600 mb-6 max-w-4xl">
                                <strong>Summary:</strong> We are shifting from a general rental model to a "Finance Product" approach. By isolating the performance of each cabin against its specific funding source, we can determine the exact <strong>Net Return</strong> and <strong>Payback Period</strong> per asset.
                            </p>
                            <table class="w-full text-left border-collapse">
                                <thead class="text-xs uppercase text-slate-400 font-bold border-b border-slate-100">
                                    <tr>
                                        <th class="py-3 px-2">Objective</th>
                                        <th class="py-3 px-2">Current State</th>
                                        <th class="py-3 px-2">Target Outcome</th>
                                    </tr>
                                </thead>
                                <tbody class="text-sm divide-y divide-slate-50">
                                    <tr>
                                        <td class="py-4 px-2 font-medium text-slate-800">True Net Result</td>
                                        <td class="py-4 px-2 text-red-500">Blended (Unknown)</td>
                                        <td class="py-4 px-2 text-emerald-600 font-bold">Exact Profit per Loan/Asset Pair</td>
                                    </tr>
                                    <tr>
                                        <td class="py-4 px-2 font-medium text-slate-800">Refinancing Strategy</td>
                                        <td class="py-4 px-2 text-red-500">Reactive</td>
                                        <td class="py-4 px-2 text-slate-600">Target high-interest loans for payout based on yield data.</td>
                                    </tr>
                                    <tr>
                                        <td class="py-4 px-2 font-medium text-slate-800">Payback Clarity</td>
                                        <td class="py-4 px-2 text-slate-500">Estimated (2.5 yrs)</td>
                                        <td class="py-4 px-2 text-slate-600">Actual timeline to free cashflow per asset.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="flex flex-col gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-soft border border-slate-100 flex flex-col justify-between" style="min-height: 250px;">
                            <h4 class="text-xs font-bold text-slate-500 uppercase mb-4 tracking-wider flex items-center gap-2">
                                <span class="w-2 h-2 rounded-full bg-blue-500"></span>
                                Cash Position Trend
                            </h4>
                            <div class="flex-1 w-full h-full relative" style="height: 180px;">
                                <canvas id="cashTrendChart"></canvas>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-xl shadow-soft border border-slate-100 flex flex-col justify-between" style="min-height: 250px;">
                            <h4 class="text-xs font-bold text-slate-500 uppercase mb-4 tracking-wider flex items-center gap-2">
                                <span class="w-2 h-2 rounded-full bg-red-500"></span>
                                Debt & Repayments
                            </h4>
                            <div class="flex-1 w-full h-full relative" style="height: 180px;">
                                <canvas id="loanTrendChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VIEW: CLEANSE -->
                <div id="view-cleanse" class="view-section hidden animate-fade-up">
                    <div class="max-w-5xl mx-auto">

                        <!-- Cleanse Header -->
                        <div class="mb-10">
                            <div class="text-center mb-6">
                                <h2 class="text-2xl font-bold text-slate-800">Cleanse: Resetting the Data Foundation</h2>
                                <p class="text-sm text-slate-500">To enable the Finance Product model, we must fix the data structure first.</p>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-0 border border-slate-200 rounded-xl overflow-hidden shadow-sm">
                                <!-- Current -->
                                <div class="bg-slate-50 p-8 flex flex-col items-center justify-center text-center border-b lg:border-b-0 lg:border-r border-slate-200">
                                    <span class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4">Current Reality</span>
                                    <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center mb-4 shadow-sm text-slate-300">
                                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                    </div>
                                    <h4 class="font-bold text-slate-700 text-lg mb-2">Unknown Yield</h4>
                                    <p class="text-sm text-slate-500 max-w-xs">We know total debt ($813k) and total assets ($1.3m), but we don't know which specific loan bought which specific cabin.</p>
                                </div>

                                <!-- Future -->
                                <div class="bg-white p-8 flex flex-col items-center justify-center text-center">
                                    <span class="text-xs font-bold text-purple-500 uppercase tracking-widest mb-4">Target State</span>
                                    <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mb-4 shadow-sm text-purple-600">
                                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                                        </svg>
                                    </div>
                                    <h4 class="font-bold text-purple-800 text-lg mb-2">Asset-Loan Matching</h4>
                                    <p class="text-sm text-slate-600 max-w-xs"><strong>Precision:</strong> Every single asset ID (C001) is hard-linked to a specific Loan ID. We know the cost of capital for every unit.</p>
                                </div>
                            </div>
                        </div>

                        <!-- 3-Step Process -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                            <!-- Step 1 -->
                            <div class="bg-white p-8 rounded-xl shadow-card border-t-4 border-purple-500 relative group hover:-translate-y-1 transition-transform">
                                <div class="absolute top-4 right-4 text-6xl font-black text-slate-100 -z-10 group-hover:text-purple-50 transition-colors">1</div>
                                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center text-purple-600 mb-6">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                                    </svg>
                                </div>
                                <h3 class="text-xl font-bold text-slate-800 mb-3">Asset ID</h3>
                                <p class="text-sm text-slate-600">Give every single cabin a unique <strong>Serial / ID</strong> (e.g., C001, C002).</p>
                            </div>

                            <!-- Step 2 -->
                            <div class="bg-white p-8 rounded-xl shadow-card border-t-4 border-blue-500 relative group hover:-translate-y-1 transition-transform">
                                <div class="absolute top-4 right-4 text-6xl font-black text-slate-100 -z-10 group-hover:text-blue-50 transition-colors">2</div>
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 mb-6">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                                    </svg>
                                </div>
                                <h3 class="text-xl font-bold text-slate-800 mb-3">Funding Link</h3>
                                <p class="text-sm text-slate-600">Assign each cabin to its specific <strong>Funding Source</strong> (e.g., BNZ Loan 01).</p>
                            </div>

                            <!-- Step 3 -->
                            <div class="bg-white p-8 rounded-xl shadow-card border-t-4 border-emerald-500 relative group hover:-translate-y-1 transition-transform">
                                <div class="absolute top-4 right-4 text-6xl font-black text-slate-100 -z-10 group-hover:text-emerald-50 transition-colors">3</div>
                                <div class="w-12 h-12 bg-emerald-100 rounded-lg flex items-center justify-center text-emerald-600 mb-6">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    </svg>
                                </div>
                                <h3 class="text-xl font-bold text-slate-800 mb-3">Utilization</h3>
                                <p class="text-sm text-slate-600">Record exactly <strong>who has which cabin</strong>.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VIEW: EXECUTE -->
                <div id="view-execute" class="view-section hidden animate-fade-up">
                    <div class="max-w-4xl mx-auto">

                        <!-- Execute Header -->
                        <div class="mb-10">
                            <div class="text-center mb-6">
                                <h2 class="text-2xl font-bold text-slate-800">Execute: New Chart of Accounts</h2>
                                <p class="text-sm text-slate-500">Restructuring the GL to reflect the Finance Product model.</p>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-0 border border-slate-200 rounded-xl overflow-hidden shadow-sm">
                                <!-- Current -->
                                <div class="bg-slate-50 p-8 flex flex-col items-center justify-center text-center border-b lg:border-b-0 lg:border-r border-slate-200">
                                    <span class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4">Current Reality</span>
                                    <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center mb-4 shadow-sm text-slate-300">
                                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
                                        </svg>
                                    </div>
                                    <h4 class="font-bold text-slate-700 text-lg mb-2">Lumped Accounts</h4>
                                    <p class="text-sm text-slate-500 max-w-xs">All rental income is in one "Cabin Rent" bucket. All interest is in one "Finance Costs" bucket. No visibility.</p>
                                </div>

                                <!-- Future -->
                                <div class="bg-white p-8 flex flex-col items-center justify-center text-center">
                                    <span class="text-xs font-bold text-emerald-500 uppercase tracking-widest mb-4">New Approach</span>
                                    <div class="w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mb-4 shadow-sm text-emerald-600">
                                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                                        </svg>
                                    </div>
                                    <h4 class="font-bold text-emerald-800 text-lg mb-2">Loan-Linked COA</h4>
                                    <p class="text-sm text-slate-600 max-w-xs"><strong>Direct Linkage:</strong> "Income - BNZ Loan 01" matches "Interest - BNZ Loan 01". Profitability is obvious.</p>
                                </div>
                            </div>
                        </div>

                        <!-- COA Structure -->
                        <div class="bg-white rounded-xl shadow-card overflow-hidden border border-slate-200">
                            <div class="grid grid-cols-2 bg-slate-50 border-b border-slate-200">
                                <div class="p-4 text-sm font-bold text-slate-700 uppercase tracking-wider text-center border-r border-slate-200">Income (Revenue)</div>
                                <div class="p-4 text-sm font-bold text-slate-700 uppercase tracking-wider text-center">Expenses (Finance)</div>
                            </div>

                            <div class="grid grid-cols-2 divide-x divide-slate-100 relative">
                                <!-- Visual Connection -->
                                <div class="absolute top-1/2 left-1/2 w-8 h-8 -ml-4 -mt-4 bg-white border border-slate-200 rounded-full flex items-center justify-center z-10 shadow-sm text-slate-300">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                                    </svg>
                                </div>

                                <!-- Income Column -->
                                <div class="p-8 space-y-4">
                                    <h4 class="text-xs font-bold text-emerald-600 uppercase mb-4">By Loan Link</h4>
                                    <div class="flex items-center gap-3 p-3 bg-emerald-50 rounded border border-emerald-100">
                                        <div class="w-2 h-2 rounded-full bg-emerald-500"></div>
                                        <span class="text-sm font-medium text-slate-700">Cabin Rent â€“ BNZ Loan 01</span>
                                    </div>
                                    <div class="flex items-center gap-3 p-3 bg-emerald-50 rounded border border-emerald-100">
                                        <div class="w-2 h-2 rounded-full bg-emerald-500"></div>
                                        <span class="text-sm font-medium text-slate-700">Cabin Rent â€“ BNZ Loan 02</span>
                                    </div>
                                    <div class="flex items-center gap-3 p-3 bg-slate-50 rounded border border-slate-100">
                                        <div class="w-2 h-2 rounded-full bg-slate-400"></div>
                                        <span class="text-sm font-medium text-slate-600">Cabin Rent â€“ Unfunded Cabins</span>
                                    </div>
                                </div>

                                <!-- Expense Column -->
                                <div class="p-8 space-y-4">
                                    <h4 class="text-xs font-bold text-red-600 uppercase mb-4">Finance Costs</h4>
                                    <div class="flex items-center gap-3 p-3 bg-red-50 rounded border border-red-100">
                                        <div class="w-2 h-2 rounded-full bg-red-500"></div>
                                        <span class="text-sm font-medium text-slate-700">Interest Expense â€“ BNZ Loan 01</span>
                                    </div>
                                    <div class="flex items-center gap-3 p-3 bg-red-50 rounded border border-red-100">
                                        <div class="w-2 h-2 rounded-full bg-red-500"></div>
                                        <span class="text-sm font-medium text-slate-700">Interest Expense â€“ BNZ Loan 02</span>
                                    </div>
                                    <div class="p-3 opacity-0"><span class="text-sm">Spacer</span></div>
                                </div>
                            </div>

                            <div class="bg-slate-50 p-4 border-t border-slate-200 text-center">
                                <p class="text-xs text-slate-500 italic">Result: Immediate visibility of profitability per funding bucket.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VIEW: PRICING -->
                <div id="view-pricing" class="view-section hidden animate-fade-up">
                    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 h-full">
                        <!-- Calculator Inputs -->
                        <div class="lg:col-span-4 bg-white p-8 rounded-2xl shadow-card h-fit space-y-6">
                            <h3 class="font-bold text-slate-800 text-xl mb-2 flex items-center gap-2">Lease Yield Model</h3>

                            <div>
                                <label class="text-xs font-bold text-slate-400 uppercase block mb-1">Build Cost (CAPEX)</label>
                                <input type="number" id="build-cost" value="15000" class="w-full border border-slate-200 rounded p-2">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-slate-400 uppercase block mb-1">Weekly Rent</label>
                                <input type="number" id="weekly-price" value="120" class="w-full border border-slate-200 rounded p-2">
                            </div>

                            <div class="pt-4 border-t border-slate-100">
                                <h4 class="text-sm font-bold text-slate-800 mb-3">Finance Overlay</h4>
                                <div>
                                    <label class="text-xs font-bold text-slate-400 uppercase block mb-1">Interest Rate (%)</label>
                                    <input type="number" id="loan-rate" value="12" class="w-full border border-slate-200 rounded p-2">
                                </div>
                                <div class="mt-3">
                                    <label class="text-xs font-bold text-slate-400 uppercase block mb-1">Loan Term (Years)</label>
                                    <input type="number" id="loan-term" value="3" class="w-full border border-slate-200 rounded p-2">
                                </div>
                            </div>
                        </div>

                        <!-- Visual Results -->
                        <div class="lg:col-span-8 bg-slate-900 rounded-2xl shadow-2xl p-8 text-white relative overflow-hidden flex flex-col justify-center">
                            <div class="grid grid-cols-2 gap-12 relative z-10 mb-8">
                                <div>
                                    <p class="text-slate-400 text-xs font-bold uppercase tracking-widest mb-1">Annual Net Yield</p>
                                    <h2 class="text-4xl font-black text-brand-success" id="res-yield">36.6%</h2>
                                </div>
                                <div>
                                    <p class="text-slate-400 text-xs font-bold uppercase tracking-widest mb-1">Cashflow Status</p>
                                    <h2 class="text-4xl font-black text-white" id="res-cashflow-status">Positive</h2>
                                </div>
                            </div>
                            <div class="bg-white/10 p-4 rounded-lg border border-white/10 relative z-10">
                                <div class="flex justify-between text-sm mb-2">
                                    <span class="text-slate-300">Annual Revenue</span>
                                    <span class="text-white font-bold" id="res-revenue">$6,000</span>
                                </div>
                                <div class="flex justify-between text-sm mb-2 border-b border-white/10 pb-2">
                                    <span class="text-slate-300">Loan Payments (P+I)</span>
                                    <span class="text-red-400 font-bold" id="res-loan-payment">-$5,800</span>
                                </div>
                                <div class="flex justify-between text-lg mt-2">
                                    <span class="text-white font-bold">Net Cashflow</span>
                                    <span class="text-brand-success font-black" id="res-net-cashflow">+$200</span>
                                </div>
                                <div class="flex justify-between text-sm mt-4 pt-2 border-t border-white/10">
                                    <span class="text-slate-300">Payback Period</span>
                                    <span class="text-white font-bold" id="res-payback">2.5 Years</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ========================================
         JAVASCRIPT APPLICATION
         ======================================== -->
    <script>
        'use strict';

        /* ========================================
           CONFIGURATION & DATA
           ======================================== */
        const CONFIG = {
            charts: {
                cashData: [92184, 70823, 48949, 67758, 57017, 66769, 109229, 115822, 115340],
                loanPayments: [16440, 16740, 16640, 16940, 16840, 16840, 17140, 21340, 17040],
                interestPaid: [6619, 6330, 6461, 6176, 6300, 6220, 5941, 6058, 6000],
                loanProceeds: [0, 0, 0, 0, 0, 0, 270000, 0, 0],
                labels: ['Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
            },
            calculator: {
                annualCost: 500 // Hardcoded operational cost
            }
        };

        /* ========================================
           APPLICATION STATE
           ======================================== */
        const AppState = {
            currentView: 'identify',
            chartsInitialized: false,
            chartInstances: {
                cash: null,
                loan: null
            }
        };

        /* ========================================
           VIEW MANAGEMENT
           ======================================== */
        class ViewManager {
            static switchView(viewName) {
                // Hide all views
                document.querySelectorAll('.view-section').forEach(el => {
                    el.classList.add('hidden');
                });

                // Remove active state from all nav items
                document.querySelectorAll('.sidebar-link').forEach(el => {
                    el.classList.remove('active');
                });

                // Show target view
                const targetView = document.getElementById(`view-${viewName}`);
                if (targetView) {
                    targetView.classList.remove('hidden');
                    AppState.currentView = viewName;
                }

                // Update navigation
                const navButton = document.querySelector(`[data-view="${viewName}"]`);
                if (navButton) {
                    navButton.classList.add('active');
                }

                // Update phase badge
                const badge = document.getElementById('phase-badge');
                if (badge) {
                    badge.textContent = viewName.toUpperCase();
                }
            }

            static enterDashboard() {
                const welcomeScreen = document.getElementById('welcome-screen');
                const dashboardContainer = document.getElementById('dashboard-container');

                if (welcomeScreen && dashboardContainer) {
                    welcomeScreen.style.display = 'none';
                    dashboardContainer.classList.remove('hidden');
                    dashboardContainer.style.display = 'flex';

                    // Initialize charts after dashboard is visible
                    setTimeout(() => {
                        ChartManager.initializeCharts();
                        Calculator.calculate();
                    }, 100);
                }
            }
        }

        /* ========================================
           CHART MANAGEMENT
           ======================================== */
        class ChartManager {
            static initializeCharts() {
                if (!window.Chart) {
                    console.error('Chart.js not loaded');
                    return;
                }

                if (AppState.chartsInitialized) {
                    return;
                }

                this.renderCashTrendChart();
                this.renderLoanTrendChart();
                AppState.chartsInitialized = true;
            }

            static destroyChart(chartId) {
                const existingChart = Chart.getChart(chartId);
                if (existingChart) {
                    existingChart.destroy();
                }
            }

            static renderCashTrendChart() {
                const canvas = document.getElementById('cashTrendChart');
                if (!canvas) return;

                this.destroyChart('cashTrendChart');

                const ctx = canvas.getContext('2d');
                const gradient = ctx.createLinearGradient(0, 0, 0, 400);
                gradient.addColorStop(0, 'rgba(59, 130, 246, 0.5)');
                gradient.addColorStop(1, 'rgba(59, 130, 246, 0.0)');

                AppState.chartInstances.cash = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: CONFIG.charts.labels,
                        datasets: [{
                            label: 'Cash Position ($)',
                            data: CONFIG.charts.cashData,
                            borderColor: '#3B82F6',
                            backgroundColor: gradient,
                            borderWidth: 3,
                            tension: 0.4,
                            fill: true,
                            pointBackgroundColor: '#fff',
                            pointBorderColor: '#3B82F6',
                            pointRadius: 4,
                            pointHoverRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                display: true,
                                grid: {
                                    borderDash: [4, 4],
                                    color: '#f1f5f9',
                                    drawBorder: false
                                }
                            },
                            x: { grid: { display: false } }
                        },
                        interaction: {
                            mode: 'nearest',
                            axis: 'x',
                            intersect: false
                        }
                    }
                });
            }

            static renderLoanTrendChart() {
                const canvas = document.getElementById('loanTrendChart');
                if (!canvas) return;

                this.destroyChart('loanTrendChart');

                const ctx = canvas.getContext('2d');

                AppState.chartInstances.loan = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: CONFIG.charts.labels,
                        datasets: [
                            {
                                type: 'line',
                                label: 'Loan Payments (Out)',
                                data: CONFIG.charts.loanPayments,
                                borderColor: '#EF4444',
                                backgroundColor: '#EF4444',
                                borderWidth: 2,
                                tension: 0.3,
                                pointRadius: 0,
                                pointHoverRadius: 4,
                                yAxisID: 'y',
                            },
                            {
                                type: 'line',
                                label: 'Interest (Out)',
                                data: CONFIG.charts.interestPaid,
                                borderColor: '#F59E0B',
                                backgroundColor: '#F59E0B',
                                borderWidth: 2,
                                borderDash: [5, 5],
                                tension: 0.3,
                                pointRadius: 0,
                                pointHoverRadius: 4,
                                yAxisID: 'y',
                            },
                            {
                                type: 'bar',
                                label: 'Loan Proceeds (In)',
                                data: CONFIG.charts.loanProceeds,
                                backgroundColor: 'rgba(16, 185, 129, 0.6)',
                                hoverBackgroundColor: 'rgba(16, 185, 129, 0.8)',
                                borderColor: 'transparent',
                                borderRadius: 4,
                                yAxisID: 'y1',
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                grid: {
                                    borderDash: [4, 4],
                                    color: '#f1f5f9',
                                    drawBorder: false
                                },
                                max: 30000
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                grid: { display: false },
                                ticks: { display: false },
                                min: 0,
                                max: 300000
                            },
                            x: { grid: { display: false } }
                        }
                    }
                });
            }
        }

        /* ========================================
           LEASE CALCULATOR
           ======================================== */
        class Calculator {
            static getElement(id) {
                return document.getElementById(id);
            }

            static calculate() {
                const buildCostEl = this.getElement('build-cost');
                const weeklyPriceEl = this.getElement('weekly-price');
                const loanRateEl = this.getElement('loan-rate');
                const loanTermEl = this.getElement('loan-term');

                if (!buildCostEl || !weeklyPriceEl || !loanRateEl || !loanTermEl) {
                    return;
                }

                const buildCost = parseFloat(buildCostEl.value) || 0;
                const weeklyPrice = parseFloat(weeklyPriceEl.value) || 0;
                const loanRate = parseFloat(loanRateEl.value) || 0;
                const loanTerm = parseFloat(loanTermEl.value) || 0;

                // Calculate operational metrics
                const annualRevenue = weeklyPrice * 52;
                const netOpIncome = annualRevenue - CONFIG.calculator.annualCost;

                // Calculate yield
                let yieldPercent = 0;
                if (buildCost > 0) {
                    yieldPercent = (netOpIncome / buildCost) * 100;
                }

                // Calculate payback period
                let paybackYears = netOpIncome > 0 ? buildCost / netOpIncome : 99;

                // Calculate financing
                let annualLoanPayment = 0;
                if (buildCost > 0 && loanTerm > 0) {
                    if (loanRate > 0) {
                        const r = loanRate / 100;
                        const n = loanTerm;
                        const numerator = buildCost * r * Math.pow(1 + r, n);
                        const denominator = Math.pow(1 + r, n) - 1;
                        if (denominator !== 0) {
                            annualLoanPayment = numerator / denominator;
                        }
                    } else {
                        annualLoanPayment = buildCost / loanTerm;
                    }
                }

                const netCashflow = netOpIncome - annualLoanPayment;

                // Update DOM
                this.updateResults({
                    revenue: annualRevenue,
                    yield: yieldPercent,
                    loanPayment: annualLoanPayment,
                    netCashflow: netCashflow,
                    payback: paybackYears
                });
            }

            static updateResults(results) {
                // Revenue
                const revEl = this.getElement('res-revenue');
                if (revEl) {
                    revEl.textContent = `$${Math.round(results.revenue).toLocaleString()}`;
                }

                // Yield
                const yieldEl = this.getElement('res-yield');
                if (yieldEl) {
                    yieldEl.textContent = `${results.yield.toFixed(1)}%`;

                    // Color based on yield
                    if (results.yield > 20) {
                        yieldEl.className = "text-4xl font-black text-brand-success";
                    } else if (results.yield > 10) {
                        yieldEl.className = "text-4xl font-black text-brand-accent";
                    } else {
                        yieldEl.className = "text-4xl font-black text-brand-danger";
                    }
                }

                // Loan Payment
                const loanEl = this.getElement('res-loan-payment');
                if (loanEl) {
                    loanEl.textContent = `-$${Math.round(results.loanPayment).toLocaleString()}`;
                }

                // Net Cashflow
                const cashflowEl = this.getElement('res-net-cashflow');
                if (cashflowEl) {
                    const sign = results.netCashflow >= 0 ? '+' : '';
                    cashflowEl.textContent = `${sign}$${Math.round(results.netCashflow).toLocaleString()}`;
                    cashflowEl.className = results.netCashflow >= 0
                        ? "text-brand-success font-black"
                        : "text-brand-danger font-black";
                }

                // Cashflow Status
                const statusEl = this.getElement('res-cashflow-status');
                if (statusEl) {
                    if (results.netCashflow > 0) {
                        statusEl.textContent = "Positive";
                        statusEl.className = "text-4xl font-black text-brand-success";
                    } else if (results.netCashflow < 0) {
                        statusEl.textContent = "Negative";
                        statusEl.className = "text-4xl font-black text-brand-danger";
                    } else {
                        statusEl.textContent = "Break Even";
                        statusEl.className = "text-4xl font-black text-brand-accent";
                    }
                }

                // Payback Period
                const paybackEl = this.getElement('res-payback');
                if (paybackEl) {
                    paybackEl.textContent = results.payback < 99
                        ? `${results.payback.toFixed(1)} Years`
                        : "N/A";
                }
            }
        }

        /* ========================================
           PARTICLE SYSTEM - ENERGY EFFECTS! âš¡
           ======================================== */
        class ParticleSystem {
            constructor(canvasId) {
                this.canvas = document.getElementById(canvasId);
                if (!this.canvas) return;

                this.ctx = this.canvas.getContext('2d');
                this.particles = [];
                this.particleCount = 80;
                this.running = false;

                this.resize();
                window.addEventListener('resize', () => this.resize());
            }

            resize() {
                if (!this.canvas) return;
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            }

            createParticle() {
                return {
                    x: Math.random() * this.canvas.width,
                    y: Math.random() * this.canvas.height,
                    size: Math.random() * 3 + 1,
                    speedX: (Math.random() - 0.5) * 0.5,
                    speedY: (Math.random() - 0.5) * 0.5,
                    opacity: Math.random() * 0.5 + 0.2,
                    color: this.getRandomColor()
                };
            }

            getRandomColor() {
                const colors = [
                    'rgba(255, 110, 0, ',  // Orange
                    'rgba(255, 0, 0, ',     // Red
                    'rgba(255, 255, 255, ', // White
                ];
                return colors[Math.floor(Math.random() * colors.length)];
            }

            init() {
                this.particles = [];
                for (let i = 0; i < this.particleCount; i++) {
                    this.particles.push(this.createParticle());
                }
            }

            update() {
                if (!this.canvas) return;

                this.particles.forEach((particle, index) => {
                    particle.x += particle.speedX;
                    particle.y += particle.speedY;

                    // Wrap around edges
                    if (particle.x < 0) particle.x = this.canvas.width;
                    if (particle.x > this.canvas.width) particle.x = 0;
                    if (particle.y < 0) particle.y = this.canvas.height;
                    if (particle.y > this.canvas.height) particle.y = 0;

                    // Pulse opacity
                    particle.opacity += (Math.random() - 0.5) * 0.02;
                    particle.opacity = Math.max(0.1, Math.min(0.7, particle.opacity));
                });
            }

            draw() {
                if (!this.ctx || !this.canvas) return;

                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

                // Draw particles
                this.particles.forEach(particle => {
                    this.ctx.beginPath();
                    this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                    this.ctx.fillStyle = particle.color + particle.opacity + ')';
                    this.ctx.fill();

                    // Glow effect
                    this.ctx.shadowBlur = 10;
                    this.ctx.shadowColor = particle.color + '0.5)';
                });

                // Draw connections
                this.particles.forEach((p1, i) => {
                    this.particles.slice(i + 1).forEach(p2 => {
                        const dx = p1.x - p2.x;
                        const dy = p1.y - p2.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);

                        if (distance < 150) {
                            this.ctx.beginPath();
                            this.ctx.moveTo(p1.x, p1.y);
                            this.ctx.lineTo(p2.x, p2.y);
                            this.ctx.strokeStyle = `rgba(255, 110, 0, ${0.2 * (1 - distance / 150)})`;
                            this.ctx.lineWidth = 1;
                            this.ctx.stroke();
                        }
                    });
                });

                this.ctx.shadowBlur = 0;
            }

            animate() {
                if (!this.running) return;
                this.update();
                this.draw();
                requestAnimationFrame(() => this.animate());
            }

            start() {
                if (!this.canvas) return;
                this.running = true;
                this.init();
                this.animate();
            }

            stop() {
                this.running = false;
            }
        }

        /* ========================================
           EVENT HANDLERS
           ======================================== */
        class EventHandlers {
            static initialize() {
                // Enter dashboard button
                const enterBtn = document.getElementById('enter-dashboard-btn');
                if (enterBtn) {
                    enterBtn.addEventListener('click', () => ViewManager.enterDashboard());
                }

                // Navigation buttons
                document.querySelectorAll('[data-view]').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const viewName = e.currentTarget.getAttribute('data-view');
                        ViewManager.switchView(viewName);
                    });
                });

                // Calculator inputs
                const calculatorInputs = ['build-cost', 'weekly-price', 'loan-rate', 'loan-term'];
                calculatorInputs.forEach(id => {
                    const input = document.getElementById(id);
                    if (input) {
                        input.addEventListener('input', () => Calculator.calculate());
                    }
                });
            }
        }

        /* ========================================
           APPLICATION INITIALIZATION
           ======================================== */
        document.addEventListener('DOMContentLoaded', () => {
            try {
                // Initialize event handlers
                EventHandlers.initialize();

                // Initial calculator state
                Calculator.calculate();

                // Start particle system on welcome screen
                const particleSystem = new ParticleSystem('particles-canvas');
                particleSystem.start();

                // Stop particles when entering dashboard
                const originalEnterDashboard = ViewManager.enterDashboard;
                ViewManager.enterDashboard = function() {
                    particleSystem.stop();
                    originalEnterDashboard.call(this);
                };

                console.log('ðŸ”¥ Dashboard initialized with ENERGY! ðŸ’¥');
            } catch (error) {
                console.error('Initialization error:', error);
            }
        });
    </script>
</body>
</html>
